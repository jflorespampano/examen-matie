const mis_preguntas=[
	{
        "pregunta":"Son 3 características básicas de un algoritmo",
        "d1": "Definido, Finito y NO ambiguo", 
        "d2":"No ambiguo, sencillo y estructurado", 
        "d3":"escrito en un enguaje de programación, estructurado y finito", 
        "d4":"Definido, estructurada y entendible", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2014-01-07", 
		"fe_mod":"2014-01-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un  programa es', 'una secuencia de instrucciones en VB",
        "d1": "un algoritmo escrito en algún lenguaje de programación", 
        "d2":"un conjunto de pasos que resuelven un problema", 
        "d3":"una secuencia de instrucciones en cualquier lenguaje", 
        "d4":"Que un algoritmo sea finito significa que:", 
        "correcta":2, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"x",
        "d1": "x", 
        "d2":"x", 
        "d3":"x", 
        "d4":"x", 
        "correcta":2, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Que un algoritmo sea no ambiguo significa que:",
        "d1": "esta escrito con claridad", 
        "d2":"sus instrucciones no son ambiguas", 
        "d3":"se puede programar facilmente", 
        "d4":"si lo ejecuto varias veces con los mismos datos, en todas obtengo el mismo resultado", 
        "correcta":4, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un compilador es:",
        "d1": "un programa que traduce de un lenguaje a otro", 
        "d2":"un programa que permite editar el código", 
        "d3":"un programa que entiende el código en lenguaje de alto nivel", 
        "d4":"un programa que entiende el lenguaje de máquina", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"permite la ejecución de ciclos cuando sabemos el número de iteraciones:",
        "d1": "do..lop", 
        "d2":"if", 
        "d3":"while", 
        "d4":"for", 
        "correcta":4, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un editor es un programa que:",
        "d1": "permite visualizar la interfaz del rpograma", 
        "d2":"permite introducir y modificar el código", 
        "d3":"permite traducir a lenguaje de máquina", 
        "d4":"genera código ejecutable", 
        "correcta":2, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un lenguaje de alto nivel es un programa que:",
        "d1": "permite programar interfaces gráficas", 
        "d2":"genera programas mas eficientes", 
        "d3":"tiene estructuras de control de flujo y módulos", 
        "d4":"tiene sentencias para manejo de interfaz", 
        "correcta":3, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"La interfaz de un programa es aquella que:",
        "d1": "permite procesar resultados", 
        "d2":"permite programar los procesos", 
        "d3":"permite la modularidad en la entrada salida", 
        "d4":"permite la entrada salida de datos", 
        "correcta":4, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Son sentencias de interfaz para un programa de consola en VB son:",
        "d1": "write, writeln, readln", 
        "d2":"textBox, label, comboBox", 
        "d3":"sub y function", 
        "d4":"printf y readf", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Pseudocódigo es:",
        "d1": "un pseudolenguaje de programación", 
        "d2":"un lenguaje natural para describir algoritmos", 
        "d3":"una representación grafica de un algoritmo", 
        "d4":"un lenguaje de programación", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un diagreama de flujo es:",
        "d1": "un conjunto de snetencias para programar", 
        "d2":"una representación gráfica de un algoritmo", 
        "d3":"un lenguaje de programación", 
        "d4":"una respresentación natural de un algoritmo", 
        "correcta":2, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"El programa: module dos  dim s as string = 'abcdefghijk' sub main() dim t as string = mid(s,1,3) console.writeline(t) end sub  end module ",
        "d1": "muetra: abc", 
        "d2":"muestra: def", 
        "d3":"muestra: ijk", 
        "d4":"muestra: abcdefghijk", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Una asignación es:",
        "d1": "una sentecia para designar una entrada", 
        "d2":"una sentencia para designar una salida", 
        "d3":"una sentencia para almacenar una valor en una variable", 
        "d4":"una sentencia para declarar variables", 
        "correcta":3, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Una variable es:",
        "d1": "un valor en un programa", 
        "d2":"una porción de memoria donde se almacena un dato", 
        "d3":"una sentencia de un lenguaje", 
        "d4":"un almacen en disco", 
        "correcta":2, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un tipo de datos es:",
        "d1": "el fondo o dominio de valores de una variable", 
        "d2":"la descripción de una variable", 
        "d3":"un conjunto de variables", 
        "d4":"un valor de una variable en un momento dado", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Los tipos de datos primitivos en VB son:",
        "d1": "array(), int, float, string, char", 
        "d2":"int, float, double, boolean, string, char", 
        "d3":"char, boolean, string, class", 
        "d4":"function, sub, for, if, whil", 
        "correcta":2, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	},
	{
		"pregunta":"Un interprete es un programa que:",
        "d1": "traduce y ejecuta un programa línea por línea", 
        "d2":"traduce un programa y lo ejecuta completo", 
        "d3":"interpreta el resultado de un programa", 
        "d4":"traduce un programa en archivo", 
        "correcta":1, 
        "fk_profesor":"1", 
        "fk_materia":"pr1", 
        "fk_tema":1, 
        "fe_crea":"2023-10-07", 
		"fe_mod":"2023-10-07", 
		"activo":"S"
	}
]

const SQL_CREA_TABLA=`CREATE TABLE IF NOT EXISTS tbl_pregunta (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    pregunta varchar(800) DEFAULT NULL,
    d1 varchar(250) DEFAULT NULL,
    d2 varchar(250) DEFAULT NULL,
    d3 varchar(250) DEFAULT NULL,
    d4 varchar(250) DEFAULT NULL,
    correcta smallint(6) DEFAULT NULL,
    fk_profesor INTEGER,
    fk_materia INTEGER,
    fk_tema INTEGER,
    fe_crea date DEFAULT NULL,
    fe_mod date DEFAULT NULL,
    activo char(1) DEFAULT NULL
  );`
const SQL_INSERT=`INSERT INTO tbl_pregunta 
(pregunta,d1,d2,d3,d4,correcta,fk_profesor,fk_materia,fk_tema,fe_crea,fe_mod,activo) 
VALUES (?,?,?,?,?,?,?,?,?,?,?,?)`
const SQL_SELECT_ALL=`SELECT * FROM tbl_pregunta`
const SQL_SELECT_ONE=`SELECT * FROM tbl_pregunta WHERE id = ?`
const SQL_UPDATE=`UPDATE tbl_pregunta 
SET pregunta = ?, d1 = ?, d2 = ?, d3 = ?, d4=?, correcta=?, fk_profesor=?,
fk_materia=?, fk_tema=?    
WHERE id = ?`
const SQL_DELETE=`DELETE FROM tbl_pregunta WHERE id = ?`

class PreguntaRepository{
    constructor(dao){
        this.dao=dao;
    }
    createTable(){
        const sql = SQL_CREA_TABLA
        return this.dao.run(sql)
    }
    create(mi_pregunta) {
        const { pregunta,d1,d2,d3,d4,correcta,fk_profesor,fk_materia,fk_tema,fe_crea,fe_mod,activo} = mi_pregunta
        return this.dao.run(
            SQL_INSERT,
            [pregunta,d1,d2,d3,d4,correcta,fk_profesor,fk_materia,fk_tema,fe_crea,fe_mod,activo])
    }
    update(mi_pregunta) {
        const { id,pregunta,d1,d2,d3,d4,correcta,fk_profesor,fk_materia,fk_tema} = mi_pregunta
        return this.dao.run(
            SQL_UPDATE,
            [pregunta,d1,d2,d3,d4,correcta,fk_profesor,fk_materia,fk_tema,id]
        )
    }
    delete(id) {
        return this.dao.run(
            SQL_DELETE,
            [id]
        )
    }
    getById(id) {
        return this.dao.get(
            SQL_SELECT_ONE,
            [id])
    }
    getAll() {
        return this.dao.all(SQL_SELECT_ALL)
    }
    getAllAleatory(){
        return this.dao.all(`
            SELECT * FROM tbl_pregunta
            ORDER BY random() 
            LIMIT 5;
        `)
    }
    existe_tabla(){
        const sql=`SELECT name FROM sqlite_master WHERE type='table' AND name='tbl_pregunta';`
        return this.dao.get(sql)
    }
    crea_y_puebla(){
        return this.existe_tabla()
        .then(result=>{
            if(result ===  undefined){
                console.log("No xiste la tabla => se crea y se puebla")
                return this.createTable()
                .then(
                    (data)=>{
                        //puebla la nueva tabla
                        return Promise.all(mis_preguntas.map((pregunta)=>{
                            return this.create(pregunta)
                        }))
                    }
                )
            }
            else{
                console.log("En crea y puebla , tabla existente, no se puebla")
                return Promise.resolve("tabla existente")
            }
        })
        .catch((err)=>{
            return new Promise((_,reject)=>{
                reject("Error "+err)
            })
        })
    }
}

export default PreguntaRepository